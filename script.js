const groups = [
    // --- Cdzinhas (4) ---
    {
        id: 1,
        name: "CDzinhas Brasil",
        category: "Cdzinhas",
        image: "assets/default_cover.png",
        views: "552",
        type: "whatsapp",
        desc: "O acervo mais completo de CDs do Brasil. ConteÃºdos exclusivos que vocÃª nÃ£o encontra em lugar nenhum. Entre e confira agora!",
        link: "grupo-whatsapp-cdzinhas-brasil.html",
        date: "18/02/2026"
    },
    {
        id: 2,
        name: "Bordel das GÃ³ticas",
        category: "Cdzinhas",
        image: "assets/default_cover.png",
        views: "482",
        type: "telegram",
        desc: "Aqui as gÃ³ticas mais safadas e taradas de sexo.",
        link: "grupo-telegram-bordel-das-goticas.html",
        date: "19/02/2026"
    },
    {
        id: 3,
        name: "GÃ³ticas Rabudas",
        category: "Cdzinhas",
        image: "assets/default_cover.png",
        views: "597",
        type: "whatsapp",
        desc: "Uma seleÃ§Ã£o de rabas gÃ³ticas gigantes que vÃ£o fazer vocÃª perder o juÃ­zo. Preparado pra essa tentaÃ§Ã£o?",
        link: "grupo-whatsapp-goticas-rabudas.html",
        date: "22/02/2026"
    },
    {
        id: 4,
        name: "Femboys BR",
        category: "Cdzinhas",
        image: "assets/default_cover.png",
        views: "343",
        type: "whatsapp",
        desc: "Os femboys mais delicados e provocantes do Brasil estÃ£o aqui. Beleza andrÃ³gina e muita safadeza te esperando.",
        link: "grupo-whatsapp-femboys-br.html",
        date: "22/02/2026"
    },

    // --- Gays (5) ---
    {
        id: 5,
        name: "Brotheragem 2026",
        category: "Gays",
        image: "assets/default_cover.png",
        views: "922",
        type: "telegram",
        desc: "Sem frescura e direto ao ponto. Brotheragem de verdade, na sigilo e com muito prazer envolvido.",
        link: "grupo-telegram-brotheragem-2026.html",
        date: "18/02/2026"
    },
    {
        id: 6,
        name: "Brincadeira de Macho",
        category: "Gays",
        image: "assets/default_cover.png",
        views: "933",
        type: "telegram",
        desc: "Onde machos alphas relaxam. Brincadeiras pesadas, testosterona lÃ¡ em cima e zero tabu.",
        link: "grupo-telegram-brincadeira-de-macho.html",
        date: "22/02/2026"
    },
    {
        id: 7,
        name: "Fut dos Rapazes",
        category: "Gays",
        image: "assets/default_cover.png",
        views: "326",
        type: "telegram",
        desc: "O pÃ³s-jogo que vocÃª sempre sonhou. A resenha comeÃ§a no campo e termina no vestiÃ¡rio, bem quente.",
        link: "grupo-telegram-fut-dos-rapazes.html",
        date: "20/02/2026"
    },
    {
        id: 8,
        name: "SensaÃ§Ã£o Gay",
        category: "Gays",
        image: "assets/default_cover.png",
        views: "558",
        type: "whatsapp",
        desc: "Descubra novas sensaÃ§Ãµes e experiÃªncias intensas. Un mundo de prazer gay sem limites pra vocÃª explorar.",
        link: "grupo-whatsapp-sensacao-gay.html",
        date: "20/02/2026"
    },
    {
        id: 9,
        name: "Gays Exibidos",
        category: "Gays",
        image: "assets/default_cover.png",
        views: "359",
        type: "whatsapp",
        desc: "Eles adoram se mostrar e vocÃª vai adorar ver. Exibicionismo amador real, cru e delicioso.",
        link: "grupo-whatsapp-gays-exibidos.html",
        date: "20/02/2026"
    },

    // --- Cornos (5) ---
    {
        id: 10,
        name: "Covil dos Cornos",
        category: "Cornos",
        image: "assets/default_cover.png",
        views: "777",
        type: "whatsapp",
        desc: "O santuÃ¡rio para quem ama ver sua mulher nos braÃ§os de outro. Aqui seu fetiche Ã© nossa prioridade.",
        link: "grupo-whatsapp-covil-dos-cornos.html",
        date: "22/02/2026"
    },
    {
        id: 11,
        name: "ExibiÃ§Ã£o Cuckold 2.0",
        category: "Cornos",
        image: "assets/default_cover.png",
        views: "662",
        type: "telegram",
        desc: "Esposas gostosas que adoram provocar e humilhar seus maridos. Venha assistir de camarote.",
        link: "grupo-telegram-exibicao-cuckold-2-0.html",
        date: "19/02/2026"
    },
    {
        id: 12,
        name: "Putas de Corno",
        category: "Cornos",
        image: "assets/default_cover.png",
        views: "582",
        type: "whatsapp",
        desc: "Elas mandam, e vocÃª obedece. Mulheres dominadoras procurando cornos submissos pra servir agora.",
        link: "grupo-whatsapp-putas-de-corno.html",
        date: "17/02/2026"
    },
    {
        id: 13,
        name: "ExibiÃ§Ã£o Brasil",
        category: "Cornos",
        image: "assets/default_cover.png",
        views: "449",
        type: "whatsapp",
        desc: "Casais reais caindo na putaria. Veja esposas brasileiras traindo e se exibindo sem pudor.",
        link: "grupo-whatsapp-exibicao-brasil.html",
        date: "21/02/2026"
    },
    {
        id: 14,
        name: "Flagras de Esposas",
        category: "Cornos",
        image: "assets/default_cover.png",
        views: "736",
        type: "telegram",
        desc: "VÃ­deos amadores vazados de esposas infiÃ©is. O proibido nunca foi tÃ£o excitante.",
        link: "grupo-telegram-flagras-de-esposas.html",
        date: "15/02/2026"
    },

    // --- Putaria 24h (5) (Moved up as per user list) ---
    {
        id: 29,
        name: "Putaria sem Fim",
        category: "Putaria 24h",
        image: "assets/default_cover.png",
        views: "903",
        type: "whatsapp",
        desc: "Sem regras, sem limites, sÃ³ putaria pesada. O grupo que nunca dorme e onde tudo Ã© permitido.",
        link: "grupo-whatsapp-putaria-sem-fim.html",
        date: "22/02/2026"
    },
    {
        id: 30,
        name: "Bordel do Pimpolho",
        category: "Putaria 24h",
        image: "assets/default_cover.png",
        views: "991",
        type: "telegram",
        desc: "Bem-vindo ao puteiro virtual. As melhores profissionais e amadoras servindo conteÃºdo de primeira.",
        link: "grupo-telegram-bordel-do-pimpolho.html",
        date: "22/02/2026"
    },
    {
        id: 31,
        name: "Putaria 24h",
        category: "Putaria 24h",
        image: "assets/default_cover.png",
        views: "714",
        type: "whatsapp",
        desc: "Clique e goze. ConteÃºdo frenÃ©tico 24h por dia pra saciar sua vontade a qualquer momento.",
        link: "grupo-whatsapp-putaria-24h.html",
        date: "22/02/2026"
    },
    {
        id: 33, // Was ProibidÃ£o 24h
        name: "Pode Tudo 24h",
        category: "Putaria 24h",
        image: "assets/default_cover.png",
        views: "486",
        type: "whatsapp",
        desc: "O submundo do prazer. Fetiches estranhos, bizarros e tudo o que Ã© proibido na superfÃ­cie.",
        link: "grupo-whatsapp-pode-tudo-24h.html",
        date: "22/02/2026"
    },
    {
        id: 32,
        name: "Entrou Gozou",
        category: "Putaria 24h",
        image: "assets/default_cover.png",
        views: "472",
        type: "telegram",
        desc: "RÃ¡pido, direto e eficiente. Entre, bata uma e relaxe. O melhor anti-stress que existe.",
        link: "grupo-telegram-entrou-gozou.html",
        date: "22/02/2026"
    },

    // --- Modelos (4) ---
    {
        id: 15,
        name: "Gabi Sanchez VIP",
        category: "Modelos",
        image: "assets/default_cover.png",
        views: "663",
        type: "telegram",
        desc: "Tudo o que a Gabi nÃ£o posta no Instagram estÃ¡ aqui. ConteÃºdo explÃ­cito, Ã­ntimo e sem censura.",
        link: "grupo-telegram-gabi-sanchez-vip.html",
        date: "21/02/2026"
    },
    {
        id: 16,
        name: "Luiza Mel",
        category: "Modelos",
        image: "assets/default_cover.png",
        views: "991",
        type: "telegram",
        desc: "A musa que conquistou o Brasil agora 100% nua pra vocÃª. VÃ­deos caseiros e ensaios picantes.",
        link: "grupo-telegram-luiza-mel.html",
        date: "21/02/2026"
    },
    {
        id: 17,
        name: "Paloma Silva",
        category: "Modelos",
        image: "assets/default_cover.png",
        views: "424",
        type: "telegram",
        desc: "A novinha de 19 anos mais promissora do momento. Venha ver o que ela esconde por baixo da roupa.",
        link: "grupo-telegram-paloma-silva.html",
        date: "22/02/2026"
    },
    {
        id: 18,
        name: "Amanda Fox",
        category: "Modelos",
        image: "assets/default_cover.png",
        views: "582",
        type: "whatsapp",
        desc: "Entre no grupo VIP da Amanda Fox e receba nudes diÃ¡rios direto no seu WhatsApp.",
        link: "grupo-whatsapp-amanda-fox.html",
        date: "22/02/2026"
    },

    // --- Trans (4) ---
    {
        id: 19,
        name: "Trans Brasil",
        category: "Trans",
        image: "assets/default_cover.png",
        views: "684",
        type: "whatsapp",
        desc: "A elite das trans brasileiras reunida. Corpos esculturais e surpresas deliciosas te aguardam.",
        link: "grupo-whatsapp-trans-brasil.html",
        date: "19/02/2026"
    },
    {
        id: 20,
        name: "TesÃ£o de Trans",
        category: "Trans",
        image: "assets/default_cover.png",
        views: "658",
        type: "telegram",
        desc: "Pra quem tem bom gosto e sabe o que Ã© bom. Dotadas, femininas e prontas pra realizar fantasias.",
        link: "grupo-telegram-tesao-de-trans.html",
        date: "21/02/2026"
    },
    {
        id: 21,
        name: "Mundo Trans",
        category: "Trans",
        image: "assets/default_cover.png",
        views: "958",
        type: "whatsapp",
        desc: "Mergulhe nesse mundo de prazer. O melhor acervo de conteÃºdo trans da internet, atualizado toda hora.",
        link: "grupo-whatsapp-mundo-trans.html",
        date: "21/02/2026"
    },
    {
        id: 22,
        name: "Mulheres de Pau",
        category: "Trans",
        image: "assets/default_cover.png",
        views: "992",
        type: "telegram",
        desc: "Elas sÃ£o lindas e tÃªm um segredinho que vocÃª vai adorar. Venha conferir o melhor dos dois mundos.",
        link: "grupo-telegram-mulheres-de-pau.html",
        date: "21/02/2026"
    },

    // --- Vazadas (6) ---
    {
        id: 23,
        name: "OnlyModels 2026",
        category: "Vazadas",
        image: "assets/default_cover.png",
        views: "604",
        type: "whatsapp",
        desc: "O que Ã© pago lÃ¡ fora, aqui Ã© de graÃ§a. 0800 do conteÃºdo mais exclusivo da internet. NÃ£o perca!",
        link: "grupo-whatsapp-onlymodels-2026.html",
        date: "21/02/2026"
    },
    {
        id: 24,
        name: "Vazadas Brasil",
        category: "Vazadas",
        image: "assets/default_cover.png",
        views: "719",
        type: "whatsapp",
        desc: "Caiu na net, tÃ¡ aqui! O maior banco de dados de vÃ­deos e fotos vazadas de amadoras e famosas.",
        link: "grupo-whatsapp-vazadas-brasil.html",
        date: "20/02/2026"
    },
    {
        id: 25,
        name: "Vazadas do Privacy",
        category: "Vazadas",
        image: "assets/default_cover.png",
        views: "657",
        type: "whatsapp",
        desc: "Privacy desbloqueado! Acesse packs completos sem pagar nada. A casa caiu pra elas.",
        link: "grupo-whatsapp-vazadas-do-privacy.html",
        date: "22/02/2026"
    },
    {
        id: 26,
        name: "Only Brasil",
        category: "Vazadas",
        image: "assets/default_cover.png",
        views: "516",
        type: "telegram",
        desc: "As brasileirinhas do OnlyFans vazadas na Ã­ntegra. Todo dia novidade fresquinha pra vocÃª.",
        link: "grupo-telegram-only-brasil.html",
        date: "21/02/2026"
    },
    {
        id: 27,
        name: "Vazou Brasil",
        category: "Vazadas",
        image: "assets/default_cover.png",
        views: "365",
        type: "whatsapp",
        desc: "Flagras, nudes e sex tapes que nÃ£o deveriam estar online, mas nÃ³s temos. Venha ver antes que apaguem!",
        link: "grupo-whatsapp-vazou-brasil.html",
        date: "19/02/2026"
    },
    {
        id: 28, // Was Vazou Tudo 2026
        name: "Top Models 2.0",
        category: "Vazadas",
        image: "assets/default_cover.png",
        views: "355",
        type: "telegram",
        desc: "O canal que as famosas temem. Vazamentos exclusivos e bombas diÃ¡rias. O ano comeÃ§ou quente!",
        link: "grupo-telegram-top-models-2-0.html",
        date: "22/02/2026"
    },

    // --- Amizade (3) ---
    {
        id: 34,
        name: "Amizades Reais",
        category: "Amizade",
        image: "assets/default_cover.png",
        views: "926",
        type: "whatsapp",
        desc: "Cansado de fake? Aqui a gente troca ideia de verdade, conhece gente nova e quem sabe rola algo mais.",
        link: "grupo-whatsapp-amizades-reais.html",
        date: "22/02/2026"
    },
    {
        id: 35,
        name: "Amizade e Romance",
        category: "Amizade",
        image: "assets/default_cover.png",
        views: "401",
        type: "telegram",
        desc: "Procurando sua alma gÃªmea ou sÃ³ um contatinho? O amor (e o prazer) pode estar a um clique.",
        link: "grupo-telegram-amizade-e-romance.html",
        date: "22/02/2026"
    },
    {
        id: 36,
        name: "Boteco dos Amigos",
        category: "Amizade",
        image: "assets/default_cover.png",
        views: "843",
        type: "whatsapp",
        desc: "Puxa uma cadeira e vem resenhar. Zoeira, memes e conversa fiada num ambiente descontraÃ­do.",
        link: "grupo-whatsapp-boteco-dos-amigos.html",
        date: "22/02/2026"
    }
];

const categories = [
    "Cdzinhas",
    "Gays",
    "Cornos",
    "Modelos",
    "Trans",
    "Vazadas",
    "Putaria 24h",
    "Amizade"
];

document.addEventListener('DOMContentLoaded', () => {
    

    // Shuffle groups to remove category order (User Request)
    groups.sort(() => Math.random() - 0.5);

    renderDropdown();
    renderGroups(groups);
});

let currentCategory = window.INITIAL_CATEGORY || 'Todos';

function renderDropdown() {
    const dropdown = document.getElementById('categoryDropdown');
    if (!dropdown) return;
    dropdown.innerHTML = '';

    const allCats = ['Todos', ...categories];

    allCats.forEach(cat => {
        const item = document.createElement('a');
        item.style.textDecoration = 'none';

        if (cat === 'Todos') {
            item.href = 'index.html';
        } else {
            let slug = cat.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "").replace(/[^a-z0-9]+/g, '-').replace(/^-+|-+$/g, '');
            item.href = `grupos-de-whatsapp-${slug}.html`;
        }

        item.className = `dropdown-item ${cat === currentCategory ? 'active' : ''}`;
        item.textContent = cat;
        dropdown.appendChild(item);
    });
}

function toggleCategoryMenu() {
    const dropdown = document.getElementById('categoryDropdown');
    if (dropdown) {
        dropdown.classList.toggle('show');
    }
}

// Close dropdown if clicked outside
window.onclick = function (event) {
    if (!event.target.matches('.nav-btn') && !event.target.closest('.dropdown-container')) {
        const dropdowns = document.getElementsByClassName("dropdown-content");
        for (let i = 0; i < dropdowns.length; i++) {
            const openDropdown = dropdowns[i];
            if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
            }
        }
    }
}



let currentPage = 1;
const itemsPerPage = 12;

// Filter Logic
let currentFilter = 'em-alta';

document.addEventListener('DOMContentLoaded', () => {
    const filterBtns = document.querySelectorAll('.filter-btn');

    filterBtns.forEach(btn => {
        btn.addEventListener('click', (e) => {
            // Remove active class from all buttons
            filterBtns.forEach(b => b.classList.remove('active'));

            // Add active class to clicked button
            e.currentTarget.classList.add('active');

            // Update filter state
            currentFilter = e.currentTarget.getAttribute('data-filter');

            // Reset to page 1 and re-render
            currentPage = 1;
            renderGroups(groups);
        });
    });
});

function renderGroups(data) {
    const grid = document.getElementById('groupsGrid');
    if (!grid) return;
    grid.innerHTML = '';

    let textFilter = document.getElementById('searchInput') ? document.getElementById('searchInput').value.toLowerCase() : '';

    let filtered = data.filter(group => {
        const matchesCategory = currentCategory === 'Todos' || group.category === currentCategory;
        const matchesSearch = group.name.toLowerCase().includes(textFilter) || group.desc.toLowerCase().includes(textFilter);

        let matchesType = true;
        if (currentFilter === 'telegram') {
            matchesType = group.type === 'telegram';
        } else if (currentFilter === 'whatsapp') {
            matchesType = group.type === 'whatsapp';
        }

        return matchesCategory && matchesSearch && matchesType;
    });

    // Sorting Logic
    if (currentFilter === 'data') {
        // Sort by date added (dd/mm/yyyy)
        filtered.sort((a, b) => {
            const dateA = a.date ? a.date.split('/').reverse().join('') : '0';
            const dateB = b.date ? b.date.split('/').reverse().join('') : '0';
            return dateB.localeCompare(dateA);
        });
    } else if (currentFilter === 'em-alta') {
        // Sort by views
        filtered.sort((a, b) => {
            const viewsA = parseInt(a.views.replace(/\D/g, '')) || 0;
            const viewsB = parseInt(b.views.replace(/\D/g, '')) || 0;
            return viewsB - viewsA;
        });
    }

    // Shuffle if "Todos" and no search to make it "subtle" (mixed)
    if (currentCategory === 'Todos' && !textFilter) {
        // Simple deterministic shuffle or keep order if we want consistent pages?
        // Let's rely on default order or random per session. 
        // If we re-shuffle every time we render, pagination breaks.
        // So we should shuffle ONCE on load, which is done by date injection or init.
        // Removing re-shuffle here to keep pagination stable.
    }

    // Pagination Logic
    const totalPages = Math.ceil(filtered.length / itemsPerPage);

    // Ensure current page is valid
    if (currentPage > totalPages) currentPage = 1;
    if (currentPage < 1) currentPage = 1;

    const start = (currentPage - 1) * itemsPerPage;
    const end = start + itemsPerPage;
    const paginatedItems = filtered.slice(start, end);

    paginatedItems.forEach(group => {
        const card = createCard(group);
        grid.appendChild(card);
    });

    renderPagination(totalPages);
}

function renderPagination(totalPages) {
    const pagination = document.getElementById('pagination');
    if (!pagination) return;
    pagination.innerHTML = '';

    if (totalPages <= 1) return;

    // Prev Button
    const prevBtn = document.createElement('button');
    prevBtn.className = 'page-btn';
    prevBtn.innerHTML = 'Â«'; // Double arrow
    prevBtn.disabled = currentPage === 1;
    prevBtn.onclick = () => changePage(currentPage - 1);
    pagination.appendChild(prevBtn);

    // Next Button
    const nextBtn = document.createElement('button');
    nextBtn.className = 'page-btn';
    nextBtn.innerHTML = 'Â»'; // Double arrow
    nextBtn.disabled = currentPage === totalPages;
    nextBtn.onclick = () => changePage(currentPage + 1);
    pagination.appendChild(nextBtn);
}

function changePage(newPage) {
    currentPage = newPage;
    renderGroups(groups);
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

// Add search listener
const searchInput = document.getElementById('searchInput');
if (searchInput) {
    searchInput.addEventListener('input', () => {
        renderGroups(groups);
    });
}

function createCard(group) {
    const card = document.createElement('div');
    card.className = 'group-card';

    // Telegram Icon
    const telegramIcon = `
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="12" r="12" fill="#229ED9"/>
            <path d="M17.5 7L5.5 11.5L9 12.5L16.5 8L10 13.5L9.5 17L12 14.5L15 17L17.5 7Z" fill="white"/>
        </svg>
    `;

    // WhatsApp Icon (Official Shape)
    const whatsappIcon = `
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M2.004 22L3.356 16.906C2.47 15.385 2 13.666 2 11.906C2 6.435 6.471 2 12 2C17.529 2 22 6.435 22 11.906C22 17.377 17.529 21.812 12 21.812C10.256 21.812 8.549 21.346 7.042 20.473L2.004 22ZM12 3.656C7.394 3.656 3.656 7.378 3.656 11.906C3.656 13.635 4.195 15.207 5.097 16.594L4.204 19.953L7.691 19.043C9.006 19.825 10.493 20.219 12 20.219C16.606 20.219 20.344 16.497 20.344 11.906C20.344 7.378 16.606 3.656 12 3.656ZM16.406 14.856C16.322 15.016 15.906 15.228 15.32 15.44C14.735 15.65 14.364 15.706 13.292 15.253C12.573 14.948 11.536 14.151 10.82 13.193C10.103 12.235 9.4 11.127 9.4 9.947C9.4 8.766 10.05 8.169 10.3 7.903C10.55 7.637 10.8 7.584 11.05 7.584C11.3 7.584 11.45 7.589 11.579 7.638C11.838 7.733 12.441 9.215 12.518 9.373C12.595 9.531 12.671 9.746 12.569 9.957C12.467 10.168 12.366 10.274 12.214 10.433C12.063 10.592 11.884 10.648 12.063 10.966C12.242 11.282 12.836 12.257 13.722 13.045C14.862 14.058 15.726 14.28 16.035 14.41C16.342 14.542 16.697 14.489 16.906 14.225C17.114 13.96 17.447 13.39 17.656 12.981C17.784 12.723 17.962 12.793 18.17 12.871C18.378 12.949 19.641 13.568 19.901 13.699C20.16 13.83 20.328 13.895 20.388 13.999C20.449 14.105 20.449 14.619 20.16 15.119L19.406 16.219L16.406 14.856Z" fill="#25D366"/>
        </svg>
    `;

    const platformIcon = group.type === 'whatsapp' ? whatsappIcon : telegramIcon;

    const tagClass = 'tag-' + group.category.toLowerCase().replace(/\s+/g, '').replace('24h', '');

    card.innerHTML = `
        <div class="card-img" style="background-image: url('${group.image}');"></div>
        <div class="card-body">
            <div class="group-tag ${tagClass}">
                ${group.category}
                ${platformIcon}
            </div>
            <div class="group-date">${group.date}</div>
            <div class="group-title">${group.name}</div>
            <div class="group-desc">${group.desc}</div>
            <!-- Dynamic button linking directly or using JS fallback -->
            ${(group.link && group.link.endsWith('.html'))
            ? `<a href="${group.link}" class="btn-card-join" style="text-decoration:none; display:block;">ENTRAR NO GRUPO</a>`
            : `<button class="btn-card-join" onclick="openModal(groups.find(g => g.id === ${group.id}))">ENTRAR NO GRUPO</button>`
        }
        </div>
    `;

    // Make whole card clickable (optional fallback)
    card.addEventListener('click', (e) => {
        // Prevent double firing if clicking the link/button directly
        if (e.target.tagName === 'A' || e.target.tagName === 'BUTTON') return;

        if (group.link && group.link.endsWith('.html')) {
            window.location.href = group.link;
        } else {
            openModal(group);
        }
    });

    return card;
}

function getCategoryIcon(cat) {
    const icons = {
        'Cdzinhas': 'ðŸ˜ˆ', // generic evil smile or similiar
        'Gays': 'ðŸ³ï¸â€ðŸŒˆ',
        'Cornos': 'ðŸ‚',
        'Putaria 24h': 'ðŸ”ž',
        'Modelos': 'ðŸ“¸',
        'Trans': 'âš§ï¸',
        'Vazadas': 'ðŸ”¥',
        'Amizade': 'ðŸ»'
    };
    return icons[cat] || 'ðŸ”¥';
}

function getCategoryColor(cat) {
    // Kept for modal usage if needed, but styling is mostly CSS classes now
    return '#00FF00';
}

// Standard Modal Logic
const modal = document.getElementById('groupModal');

function openModal(group) {
    if (!group || !group.name) return;

    if (!document.getElementById('modalTitle')) return;

    document.getElementById('modalTitle').textContent = group.name;

    // Views Logic matching request "âš¡ 727 Novos Acessos Hoje!" (limit 600)
    const accessesEl = document.getElementById('modalAccesses');
    if (accessesEl) {
        // Random number between 1 and 600
        const randomViews = Math.floor(Math.random() * 600) + 1;
        accessesEl.innerHTML = `âš¡ ${randomViews} Novos Acessos Hoje!`;
    }

    // Description - Ensure it starts with fire emoji if not already?
    let descBase = group.desc || "";
    if (!descBase.startsWith('ðŸ”¥')) {
        descBase = "ðŸ”¥ " + descBase;
    }
    document.getElementById('modalDesc').textContent = descBase;

    const btn = document.getElementById('modalLink');
    if (btn) {
        btn.href = group.link;
    }

    // Show Modal with Grid centering (from CSS)
    if (modal) {
        modal.style.display = 'grid';
    }
}

function closeModal() {
    if (modal) {
        modal.style.display = 'none';
    }
}

// Unified Window Click Listener
window.addEventListener('click', (event) => {
    // Dropdown Closing Logic
    const dropdownContainer = document.querySelector('.dropdown-container');
    if (!event.target.matches('.nav-btn') && (!dropdownContainer || !dropdownContainer.contains(event.target))) {
        const dropdowns = document.getElementsByClassName("dropdown-content");
        for (let i = 0; i < dropdowns.length; i++) {
            const openDropdown = dropdowns[i];
            if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
            }
        }
    }

    // Modal Closing (Click outside content)
    if (event.target === modal) {
        closeModal();
    }
});

// --- Pull to Refresh Logic ---
let startY = 0;
let currentY = 0;
let isPulling = false;
const threshold = 150; // Pull distance to trigger refresh
const reloadThreshold = 100; // Visual threshold

window.addEventListener('touchstart', (e) => {
    if (window.scrollY === 0) {
        startY = e.touches[0].clientY;
        isPulling = true;
    } else {
        isPulling = false;
    }
}, { passive: true });

window.addEventListener('touchmove', (e) => {
    if (!isPulling) return;

    currentY = e.touches[0].clientY;
    const diff = currentY - startY;

    if (diff > 0 && window.scrollY === 0) {
        // Visual cue could be added here, e.g., body transform
        // For simplicity and robustness, we just track the pull
        // A reload indicator would be nice, but checking requirements "activate reload page"
        // Let's add a simple visual indicator if possible, or just the logic.
        // The user said "activate reload page when user drag start page down"
        // Without complex UI, we can just reload if they pull far enough.

        // Let's add a temporary loading text or just rely on the action.
        // Actually, let's just use the logic for now.
    }
}, { passive: true });

window.addEventListener('touchend', (e) => {
    if (!isPulling) return;

    const diff = currentY - startY;
    if (diff > threshold && window.scrollY === 0) {
        // Trigger Reload
        location.reload();
    }

    isPulling = false;
});

// --- Sponsored Groups Logic ---

const sponsoredGroups = [
    {
        title: "CASSINO VIP",
        desc: "O maior grupo de plataformas pagantes. Sinais com 98% de assertividade 24h por dia.",
        badges: ["PATROCINADO"],
        btnText: "ENTRAR NO GRUPO",
        link: "#",
        emoji: "ðŸŽ°"
    },
    {
        title: "ONLYFANS VAZADOS",
        desc: "O acervo secreto das famosas que vocÃª sempre quis ver. Atualizado todo dia com novidades.",
        badges: ["HOT"],
        btnText: "VER CONTEÃšDO",
        link: "#",
        emoji: "ðŸ”ž"
    },
    {
        title: "DESAFIOS TIKTOK",
        desc: "Os vÃ­deos mais virais e proÃ­bidos do TikTok que nÃ£o podem ser postados lÃ¡.",
        badges: ["VIRAL"],
        btnText: "ASSISTIR AGORA",
        link: "#",
        emoji: "ðŸ”¥"
    }
];

function openSponsoredModal() {
    const modal = document.getElementById('sponsoredModal');
    const grid = document.getElementById('sponsoredGrid');
    if (!modal || !grid) return;

    // Render if empty
    if (grid.innerHTML.trim() === '') {
        grid.innerHTML = sponsoredGroups.map(group => `
            <div class="premium-group-card" onclick="window.open('${group.link}', '_blank')">
                <div class="pgc-header">
                    <div class="pgc-title-wrapper">
                        <span class="pgc-title">${group.title}</span> <span class="pgc-emoji">${group.emoji}</span>
                    </div>
                    <div class="pgc-badges">
                        ${group.badges.map(b => `<span class="badge badge-yellow">${b}</span>`).join('')}
                    </div>
                </div>
                <div class="pgc-desc">${group.desc}</div>
                <button class="pgc-btn">${group.btnText}</button>
            </div>
        `).join('');
    }

    modal.classList.add('show');
}

function closeSponsoredModal() {
    const modal = document.getElementById('sponsoredModal');
    if (modal) modal.classList.remove('show');
}

// Attach to button
document.addEventListener('DOMContentLoaded', () => {
    // Find the button by text content or class since it doesn't have an ID
    const buttons = document.querySelectorAll('.nav-btn');
    buttons.forEach(btn => {
        if (btn.textContent.includes('PATROCINADOS') && !btn.textContent.includes('ONLYMODELS')) {
            btn.onclick = openSponsoredModal;
        }
    });
});

// Close sponsored modal on outside click
window.addEventListener('click', (e) => {
    const modal = document.getElementById('sponsoredModal');
    if (e.target === modal) {
        closeSponsoredModal();
    }
});
